# Subtitles - 影片字幕產生器 設計文件

## 概述

純前端網頁應用，使用 Whisper WASM 在瀏覽器端將影片語音轉為文字，支援中文和英文，產生 SRT 字幕檔和完整文字記錄。

## 需求

- **平台：** 網頁應用（純前端，無後端）
- **輸入：** 上傳影片檔案 + 貼影片直連結（.mp4 等）
- **輸出：** SRT 字幕檔 + 完整文字記錄（可複製/下載）
- **語言：** 中文、English、自動偵測
- **引擎：** Whisper WASM（瀏覽器端離線運行）
- **UI：** 簡潔實用風格

## 架構

```
用戶操作           瀏覽器處理                    輸出
─────────────────────────────────────────────────────
上傳檔案 ──┐
           ├──▶ FFmpeg WASM ──▶ Whisper WASM ──▶ SRT 檔案
貼影片URL ──┘    (提取音訊)      (語音轉文字)      文字記錄
```

### 核心元件

- **FFmpeg WASM** — 從影片中提取音訊，轉成 16kHz 單聲道 WAV
- **Whisper WASM**（whisper.cpp WASM 編譯版）— 語音辨識引擎
- **Web Workers** — 背景執行繁重計算，保持 UI 流暢
- **純 HTML + CSS + JS** — 無框架，保持輕量

### 模型選擇

- `whisper-base`（~75MB，速度快，預設）
- `whisper-small`（~250MB，準確度更高，可選）
- 模型首次下載後快取在 IndexedDB / Cache API

## 使用流程

三步驟：**上傳 → 處理 → 下載**

### 輸入區

- 拖拽上傳 + 點擊選檔（支援 mp4, mov, webm, mkv）
- 貼上影片 URL（.mp4 直連結）
- 設定項：
  - 語言：中文（預設）/ English / 自動偵測
  - 模型：base（快速）/ small（精確）
  - 字幕間距：3秒 / 5秒（預設）/ 10秒 / 自訂

### 處理中

- 進度條顯示當前步驟
- 步驟：提取音訊 → 載入模型 → 辨識語音

### 結果區

- 分頁切換：「文字記錄」和「SRT 字幕」
- 操作按鈕：複製全部 / 下載 .srt / 下載 .txt

## 字幕間距設定

控制每段字幕的最大時間長度。段落在句子自然斷點處分割，但不超過設定的間距上限。

- 3 秒 — 短句，適合快速閱讀
- 5 秒（預設）— 平衡
- 10 秒 — 長段落，適合文字記錄
- 自訂 — 用戶輸入秒數

## 處理流程細節

1. 用戶上傳/貼連結 → 取得影片檔案
2. FFmpeg WASM 提取音訊 → 轉成 16kHz 單聲道 WAV
3. 載入 Whisper 模型（首次下載，之後從快取讀取）
4. Whisper WASM 辨識語音 → 取得帶時間戳的文字片段
5. 根據字幕間距設定重新分割段落
6. 產生 SRT 格式和純文字記錄

## 限制

- 檔案大小建議上限 500MB（瀏覽器記憶體限制）
- URL 僅支援影片直連結，不支援 YouTube 等平台連結
- 瀏覽器相容性：Chrome/Edge（推薦）、Firefox（支援）、Safari（部分支援）

## 部署

靜態檔案，可託管於 GitHub Pages / Vercel / Netlify，完全免費。
